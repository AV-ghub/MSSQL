### üìò –≠—Ç–∞–ø 1: –û–±—â–∏–π –æ–±–∑–æ—Ä WSFC

Windows Server Failover Clustering (WSFC) ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–µ—Ä–≤–µ—Ä—ã (—É–∑–ª—ã) –≤ –≥—Ä—É–ø–ø—É –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è **–≤—ã—Å–æ–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (High Availability, HA)** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å–ª—É–∂–± . WSFC –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã (–¥–∏—Å–∫–∏, IP-–∞–¥—Ä–µ—Å–∞, –∏–º–µ–Ω–∞, —Å–ª—É–∂–±—ã) –≤ –ª–æ–≥–∏—á–µ—Å–∫—É—é –µ–¥–∏–Ω–∏—Ü—É ‚Äî **—Ä–æ–ª—å (Role)**, ‚Äî –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ –ø—Ä–∏ —Å–±–æ–µ. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–æ—Ç—Ä–∞–±–æ—Ç–∫–æ–π –æ—Ç–∫–∞–∑–∞ (failover)**.

**–ö–ª—é—á–µ–≤–∞—è –∑–∞–¥–∞—á–∞ WSFC ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å "—Ä–∞—Å–∫–æ–ª –º–æ–∑–≥–∞" (split-brain)**, —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –¥–≤–∞ —É–∑–ª–∞ —Å—á–∏—Ç–∞—é—Ç —Å–µ–±—è –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏ –æ–¥–Ω–æ–π —Ä–æ–ª–∏ –∏ –Ω–∞—á–∏–Ω–∞—é—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å, —á—Ç–æ –≤–µ–¥—ë—Ç –∫ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º **–∫–≤–æ—Ä—É–º–∞**.

> ‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ: WSFC ‚Äî —ç—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –∞ –Ω–µ –≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ï–≥–æ –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –î–ª—è SQL Server —ç—Ç–æ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ (FCI) –∏ –≥—Ä—É–ø–ø—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (AG).

### üß© –≠—Ç–∞–ø 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–∑–ª–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞ (–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
–£—Å–ø–µ—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–∞ 80% –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. –í–æ—Ç —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –Ω—é–∞–Ω—Å—ã |
| :--- | :--- | :--- |
| **–û–° –∏ –¥–æ–º–µ–Ω** | –û–¥–∏–Ω–∞–∫–æ–≤–∞—è –≤–µ—Ä—Å–∏—è Windows Server –Ω–∞ –≤—Å–µ—Ö —É–∑–ª–∞—Ö . –í—Å–µ —É–∑–ª—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω—ã –∫ –æ–¥–Ω–æ–º—É –¥–æ–º–µ–Ω—É AD . | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–º–µ—â–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ (OU) –≤ AD –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ–ª–∏—Ç–∏–∫ . |
| **–°–µ—Ç—å** | –ú–∏–Ω–∏–º—É–º –¥–≤–∞ —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —É–∑–ª–µ (–¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞) . –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ . | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Management", "Heartbeat", "iSCSI") . |
| **–•—Ä–∞–Ω–∏–ª–∏—â–µ** | –î–ª—è **FCI** —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±—â–µ–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (SAN, iSCSI, SMB) . –î–ª—è **AG** ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ WSFC (–¥–∞–Ω–Ω—ã–µ —Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—Ç—Å—è). | –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ iSCSI –∏–ª–∏ SAN —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç **Multipath I/O (MPIO)** –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø—É—Ç–µ–π –¥–æ—Å—Ç—É–ø–∞ . |
| **–ü—Ä–∞–≤–∞ –≤ AD** | –£—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å, —Å–æ–∑–¥–∞—é—â–∞—è –∫–ª–∞—Å—Ç–µ—Ä, –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ **—Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ (Create Computer objects)** –≤ —Ü–µ–ª–µ–≤–æ–π OU AD . | –í —Å—Ç—Ä–æ–≥–∏—Ö –¥–æ–º–µ–Ω–∞—Ö –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞ (Cluster Name Object, CNO) –º–æ–∂–Ω–æ **–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∑–∞—Ä–∞–Ω–µ–µ (pre-stage)** . |

**–ü–æ—Ä—è–¥–æ–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏** –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
1.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –û–° –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö.
2.  –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å —Å–µ—Ä–≤–µ—Ä—ã –∫ –¥–æ–º–µ–Ω—É.
3.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ IP, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –æ—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –≤ DNS –¥–ª—è heartbeat-—Å–µ—Ç–µ–π) .
4.  –ü–æ–¥–∫–ª—é—á–∏—Ç—å –æ–±—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è FCI).
5.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å **Failover Clustering** –Ω–∞ –≤—Å–µ —É–∑–ª—ã.
    - –ß–µ—Ä–µ–∑ PowerShell: `Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools` .
    - –ß–µ—Ä–µ–∑ –î–∏—Å–ø–µ—Ç—á–µ—Ä —Å–µ—Ä–≤–µ—Ä–æ–≤ .

> **–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≤—É—à–∫–∞**: –ß–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ ‚Äî –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø—Ä–∞–≤ –≤ Active Directory. –í—Å–µ–≥–¥–∞ —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–π—Ç–µ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ –¥–æ–º–µ–Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ prestaging .

### üß™ –≠—Ç–∞–ø 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞

–ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ **–∫–∞—Ç–µ–≥–æ—Ä–∏—á–µ—Å–∫–∏ –Ω–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å** —ç—Ç–∞–ø –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

1.  **–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Validation Wizard)**.
    –≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.
    - –ß–µ—Ä–µ–∑ PowerShell: `Test-Cluster -Node Server1, Server2` .
    - –ß–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Failover Cluster Manager .
    - –í –æ—Ç—á–µ—Ç–µ –Ω—É–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ **–æ—à–∏–±–∫–∏ (Failures)**, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (Warnings)** —Å—Ç–æ–∏—Ç –∏–∑—É—á–∏—Ç—å, –Ω–æ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–ø—É—Å—Ç–∏–º—ã .

2.  **–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞**. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä.
    - –ß–µ—Ä–µ–∑ PowerShell: `New-Cluster -Name ClusterName -Node Node1,Node2 -StaticAddress 192.168.1.100` .
    - –ß–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å .
    - –í –ø—Ä–æ—Ü–µ—Å—Å–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å **–∏–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞** –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π **IP-–∞–¥—Ä–µ—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** –∏–º. –≠—Ç–æ—Ç IP-–∞–¥—Ä–µ—Å **–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤–æ–±–æ–¥–µ–Ω –≤ —Å–µ—Ç–∏** .

–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤ Active Directory —Å–æ–∑–¥–∞–µ—Ç—Å—è **–æ–±—ä–µ–∫—Ç –∏–º–µ–Ω–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ (CNO)**, –∞ –≤ DNS ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –∑–∞–ø–∏—Å—å .
